(this["webpackJsonpdefi-account-summary"]=this["webpackJsonpdefi-account-summary"]||[]).push([[0],{201:function(e,t,n){},214:function(e,t){},237:function(e,t){},239:function(e,t){},316:function(e,t){},318:function(e,t){},350:function(e,t){},355:function(e,t){},357:function(e,t){},364:function(e,t){},377:function(e,t){},456:function(e,t,n){},457:function(e,t,n){"use strict";n.r(t);var a=n(15),s=n(46),i=n.n(s),o=n(191),c=n.n(o),u=(n(201),n(21)),r=n.n(u),p=n(102),l=n(5),d=n(6),m=n(10),y=n(9),f=n(192),h=n.n(f),b=[{constant:!0,inputs:[],name:"name",outputs:[{name:"",type:"string"}],payable:!1,type:"function"},{constant:!0,inputs:[],name:"symbol",outputs:[{name:"",type:"string"}],payable:!1,type:"function"},{constant:!0,inputs:[],name:"decimals",outputs:[{name:"",type:"uint8"}],payable:!1,type:"function"},{constant:!0,inputs:[],name:"totalSupply",outputs:[{name:"",type:"uint256"}],payable:!1,type:"function"},{constant:!0,inputs:[{name:"_owner",type:"address"}],name:"balanceOf",outputs:[{name:"balance",type:"uint256"}],payable:!1,type:"function"},{constant:!1,inputs:[{name:"_to",type:"address"},{name:"_value",type:"uint256"}],name:"transfer",outputs:[{name:"success",type:"bool"}],payable:!1,type:"function"},{constant:!1,inputs:[{name:"_from",type:"address"},{name:"_to",type:"address"},{name:"_value",type:"uint256"}],name:"transferFrom",outputs:[{name:"success",type:"bool"}],payable:!1,type:"function"},{constant:!1,inputs:[{name:"_spender",type:"address"},{name:"_value",type:"uint256"}],name:"approve",outputs:[{name:"success",type:"bool"}],payable:!1,type:"function"},{constant:!0,inputs:[{name:"_owner",type:"address"},{name:"_spender",type:"address"}],name:"allowance",outputs:[{name:"remaining",type:"uint256"}],payable:!1,type:"function"},{anonymous:!1,inputs:[{indexed:!0,name:"_from",type:"address"},{indexed:!0,name:"_to",type:"address"},{indexed:!1,name:"_value",type:"uint256"}],name:"Transfer",type:"event"},{anonymous:!1,inputs:[{indexed:!0,name:"_owner",type:"address"},{indexed:!0,name:"_spender",type:"address"},{indexed:!1,name:"_value",type:"uint256"}],name:"Approval",type:"event"},{inputs:[{name:"_initialAmount",type:"uint256"},{name:"_tokenName",type:"string"},{name:"_decimalUnits",type:"uint8"},{name:"_tokenSymbol",type:"string"}],payable:!1,type:"constructor"},{constant:!1,inputs:[{name:"_spender",type:"address"},{name:"_value",type:"uint256"},{name:"_extraData",type:"bytes"}],name:"approveAndCall",outputs:[{name:"success",type:"bool"}],payable:!1,type:"function"},{constant:!0,inputs:[],name:"version",outputs:[{name:"",type:"string"}],payable:!1,type:"function"}],v=n(462),k=(n(456),function(e){Object(m.a)(n,e);var t=Object(y.a)(n);function n(e){var a;return Object(l.a)(this,n),(a=t.call(this,e)).relevantTokens=["DAI","LINK","UNI","AAVE","SUSHI","SNX","COMP","ZRX","FTM","MIR","1INCH"],a.state={web3:void 0,accountAddress:void 0,isLoaded:!1,ethBalance:void 0,allTokens:{},tokenBalances:{},tokenPrices:{}},a}return Object(d.a)(n,[{key:"isMetamaskInstalled",value:function(){return"undefined"!==typeof window.ethereum}},{key:"updateEthBalance",value:function(e){if(this.state.web3){var t=this.state.web3.utils.fromWei(e);this.setState({ethBalance:t})}else console.error("web3 is not yet initialized")}},{key:"updateTokenBalance",value:function(e,t){if(this.state.web3){var n=this.state,a=n.tokenBalances,s=n.web3;a[e]=s.utils.fromWei(t),this.setState({tokenBalances:a})}else console.error("web3 is not yet initialized")}},{key:"connectToMetaMask",value:function(){var e=Object(p.a)(r.a.mark((function e(){var t,n,a,s=this;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,window.ethereum.request({method:"eth_requestAccounts"});case 2:t=e.sent,n=t[0],a=new h.a(window.ethereum),this.setState({web3:a,accountAddress:n}),a.eth.getBalance(n).then(this.updateEthBalance.bind(this)),this.relevantTokens.forEach((function(e){var t=s.state.allTokens[e].address;new a.eth.Contract(b,t).methods.balanceOf(n).call().then((function(t){s.updateTokenBalance(e,t)})),s.fetchTokenPrice(t).then((function(t){var n=s.state.tokenPrices;n[e]=t,s.setState({tokenPrices:n})}))}));case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"fetchTokenPrice",value:function(){var e=Object(p.a)(r.a.mark((function e(t){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",fetch("https://api.coingecko.com/api/v3/simple/token_price/ethereum?contract_addresses=".concat(t,"&vs_currencies=usd")).then((function(e){return e.json()})).then((function(e){return Object.values(e)[0].usd})));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"componentDidMount",value:function(){var e=this;fetch("https://api.1inch.exchange/v2.0/tokens").then((function(e){return e.json()})).then((function(t){var n={};Object.values(t.tokens).forEach((function(e,t,a){n[e.symbol]=e})),e.setState({isLoaded:!0,allTokens:n})}))}},{key:"renderTokenBalance",value:function(e){var t=this.state,n=t.tokenBalances,s=t.tokenPrices,i=e.symbol,o=+n[i],c=+s[i]*o,u=Object(v.a)("$,.2f"),r=Object(v.a)(".2f");if(o)return Object(a.jsxs)("li",{children:[Object(a.jsx)("strong",{children:i}),": ",r(o)," (",u(c),")"]},i)}},{key:"render",value:function(){if(!this.state)return Object(a.jsx)("div",{children:"Loading..."});var e=this.state,t=e.allTokens,n=e.ethBalance,s=e.accountAddress,i=Object(v.a)(".2f");return Object(a.jsxs)("div",{className:"App",children:[Object(a.jsx)("h1",{children:"DeFi account summary"}),Object(a.jsx)("h2",{children:"Account token balances"}),this.isMetamaskInstalled()&&!this.state.web3&&Object(a.jsx)("button",{onClick:this.connectToMetaMask.bind(this),children:"Connect to MetaMask"}),s&&Object(a.jsxs)("p",{children:["Address: ",s]}),Object(a.jsxs)("ul",{children:[n&&Object(a.jsxs)("li",{children:[Object(a.jsx)("strong",{children:"ETH"}),": ",i(+n)]}),Object.values(t).map(this.renderTokenBalance.bind(this))]})]})}}]),n}(i.a.Component)),j=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,463)).then((function(t){var n=t.getCLS,a=t.getFID,s=t.getFCP,i=t.getLCP,o=t.getTTFB;n(e),a(e),s(e),i(e),o(e)}))};c.a.render(Object(a.jsx)(i.a.StrictMode,{children:Object(a.jsx)(k,{})}),document.getElementById("root")),j()}},[[457,1,2]]]);
//# sourceMappingURL=main.0fe10230.chunk.js.map