(this["webpackJsonpdefi-account-summary"]=this["webpackJsonpdefi-account-summary"]||[]).push([[0],{202:function(e,t,n){},215:function(e,t){},238:function(e,t){},240:function(e,t){},317:function(e,t){},319:function(e,t){},351:function(e,t){},356:function(e,t){},358:function(e,t){},365:function(e,t){},378:function(e,t){},457:function(e,t,n){},458:function(e,t,n){"use strict";n.r(t);var a=n(8),s=n(47),r=n.n(s),i=n(191),c=n.n(i),o=(n(202),n(194)),u=n(14),l=n.n(u),d=n(35),p=n(5),b=n(6),h=n(11),m=n(10),y=n(192),f=n.n(y),x=[{constant:!0,inputs:[],name:"name",outputs:[{name:"",type:"string"}],payable:!1,type:"function"},{constant:!0,inputs:[],name:"symbol",outputs:[{name:"",type:"string"}],payable:!1,type:"function"},{constant:!0,inputs:[],name:"decimals",outputs:[{name:"",type:"uint8"}],payable:!1,type:"function"},{constant:!0,inputs:[],name:"totalSupply",outputs:[{name:"",type:"uint256"}],payable:!1,type:"function"},{constant:!0,inputs:[{name:"_owner",type:"address"}],name:"balanceOf",outputs:[{name:"balance",type:"uint256"}],payable:!1,type:"function"},{constant:!1,inputs:[{name:"_to",type:"address"},{name:"_value",type:"uint256"}],name:"transfer",outputs:[{name:"success",type:"bool"}],payable:!1,type:"function"},{constant:!1,inputs:[{name:"_from",type:"address"},{name:"_to",type:"address"},{name:"_value",type:"uint256"}],name:"transferFrom",outputs:[{name:"success",type:"bool"}],payable:!1,type:"function"},{constant:!1,inputs:[{name:"_spender",type:"address"},{name:"_value",type:"uint256"}],name:"approve",outputs:[{name:"success",type:"bool"}],payable:!1,type:"function"},{constant:!0,inputs:[{name:"_owner",type:"address"},{name:"_spender",type:"address"}],name:"allowance",outputs:[{name:"remaining",type:"uint256"}],payable:!1,type:"function"},{anonymous:!1,inputs:[{indexed:!0,name:"_from",type:"address"},{indexed:!0,name:"_to",type:"address"},{indexed:!1,name:"_value",type:"uint256"}],name:"Transfer",type:"event"},{anonymous:!1,inputs:[{indexed:!0,name:"_owner",type:"address"},{indexed:!0,name:"_spender",type:"address"},{indexed:!1,name:"_value",type:"uint256"}],name:"Approval",type:"event"},{inputs:[{name:"_initialAmount",type:"uint256"},{name:"_tokenName",type:"string"},{name:"_decimalUnits",type:"uint8"},{name:"_tokenSymbol",type:"string"}],payable:!1,type:"constructor"},{constant:!1,inputs:[{name:"_spender",type:"address"},{name:"_value",type:"uint256"},{name:"_extraData",type:"bytes"}],name:"approveAndCall",outputs:[{name:"success",type:"bool"}],payable:!1,type:"function"},{constant:!0,inputs:[],name:"version",outputs:[{name:"",type:"string"}],payable:!1,type:"function"}],j=n(463),v=(n(457),function(e){Object(h.a)(n,e);var t=Object(m.a)(n);function n(e){var a;return Object(p.a)(this,n),(a=t.call(this,e)).state={web3:void 0,accountAddress:void 0,isLoaded:!1,ethBalance:void 0,allTokens:{},tokenBalances:{},tokenPrices:{}},a}return Object(b.a)(n,[{key:"isMetamaskInstalled",value:function(){return"undefined"!==typeof window.ethereum}},{key:"updateEthBalance",value:function(){var e=Object(d.a)(l.a.mark((function e(t){var n,a,s;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.state.web3){e.next=11;break}return n=this.state.web3.utils.fromWei(t),this.setState({ethBalance:n}),e.next=5,this.fetchEthPrice();case 5:a=e.sent,(s=this.state.tokenPrices).ETH=a,this.setState({tokenPrices:s}),e.next=12;break;case 11:console.error("web3 is not yet initialized");case 12:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"updateTokenBalance",value:function(e,t){if(this.state.web3){var n=this.state.web3.utils.fromWei(t);if(+n>0){var a=this.state,s=a.tokenBalances,r=a.allTokens;s[e]=n,this.fetchTokenPrices([r[e].address]),this.setState({tokenBalances:s})}}else console.error("web3 is not yet initialized")}},{key:"fetchTokenBalance",value:function(){var e=Object(d.a)(l.a.mark((function e(t,n){var a,s,r,i;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=this.state.accountAddress,s=n.address,r=new t.eth.Contract(x,s),e.next=5,r.methods.balanceOf(a).call();case 5:i=e.sent,this.updateTokenBalance(n.symbol,i);case 7:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"connectToMetaMask",value:function(){var e=Object(d.a)(l.a.mark((function e(){var t,n,a,s=this;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,window.ethereum.request({method:"eth_requestAccounts"});case 2:t=e.sent,n=t[0],a=new f.a(window.ethereum),this.setState({web3:a,accountAddress:n}),a.eth.getBalance(n).then(this.updateEthBalance.bind(this)),Object.values(this.state.allTokens).forEach((function(e){s.fetchTokenBalance(a,e)}));case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"findTokenByAddress",value:function(e){var t=this.state.allTokens;return Object.values(t).find((function(t){return t.address===e}))}},{key:"fetchEthPrice",value:function(){var e=Object(d.a)(l.a.mark((function e(){var t,n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("https://api.coingecko.com/api/v3/simple/price?ids=ethereum&vs_currencies=usd");case 2:return t=e.sent,e.next=5,t.json();case 5:return n=e.sent,e.abrupt("return",n.ethereum.usd);case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"fetchTokenPrices",value:function(){var e=Object(d.a)(l.a.mark((function e(t){var n,a,s,r,i=this;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.join(","),a="https://api.coingecko.com/api/v3/simple/token_price/ethereum?contract_addresses=".concat(n,"&vs_currencies=usd"),e.next=4,fetch(a);case 4:return s=e.sent,e.next=7,s.json();case 7:r=e.sent,Object.entries(r).forEach((function(e){var t=Object(o.a)(e,2),n=t[0],a=t[1],s=i.findTokenByAddress(n);if(s){var r=a.usd,c=i.state.tokenPrices;c[s.symbol]=r,i.setState({tokenPrices:c})}else console.error("Unable to find token with address ".concat(n))}));case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"componentDidMount",value:function(){var e=Object(d.a)(l.a.mark((function e(){var t,n,a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("https://api.1inch.exchange/v2.0/tokens");case 2:return t=e.sent,e.next=5,t.json();case 5:n=e.sent,a={},Object.values(n.tokens).forEach((function(e,t,n){a[e.symbol]=e})),this.setState({isLoaded:!0,allTokens:a});case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"renderTokenBalance",value:function(e){var t=this.state,n=t.tokenBalances,s=t.tokenPrices,r=e.symbol,i=+n[r],c=+s[r],o=c*i,u=Object(j.a)("$,.2f"),l=Object(j.a)(".2f");if(i)return Object(a.jsxs)("tr",{children:[Object(a.jsx)("td",{className:"border border-light-blue-500 px-4 py-2 text-light-blue-600 font-medium",children:r}),Object(a.jsx)("td",{className:"border border-light-blue-500 px-4 py-2 text-light-blue-600 font-medium",children:l(i)}),Object(a.jsx)("td",{className:"border border-light-blue-500 px-4 py-2 text-light-blue-600 font-medium",children:u(c)}),Object(a.jsx)("td",{className:"border border-light-blue-500 px-4 py-2 text-light-blue-600 font-medium",children:u(o)})]},r)}},{key:"render",value:function(){if(!this.state)return Object(a.jsx)("div",{children:"Loading..."});var e=this.state,t=e.allTokens,n=e.ethBalance,s=e.accountAddress,r=e.tokenBalances,i=Object(j.a)(".2f"),c=Object(j.a)("$,.2f"),o=+this.state.tokenPrices.ETH;return Object(a.jsx)("div",{className:"min-h-screen bg-gray-100 py-6 flex flex-col justify-center sm:py-12",children:Object(a.jsxs)("div",{className:"relative py-3 sm:max-w-xl sm:mx-auto",children:[Object(a.jsx)("div",{className:"absolute inset-0 bg-gradient-to-r from-cyan-400 to-light-blue-500 shadow-lg transform -skew-y-6 sm:skew-y-0 sm:-rotate-6 sm:rounded-3xl"}),Object(a.jsx)("div",{className:"relative px-4 py-10 bg-white shadow-lg sm:rounded-3xl sm:p-20",children:Object(a.jsx)("div",{className:"max-w-md mx-auto",children:Object(a.jsx)("div",{className:"divide-y divide-gray-200",children:Object(a.jsxs)("div",{className:"py-8 text-base leading-6 space-y-4 text-gray-700 sm:text-lg sm:leading-7",children:[Object(a.jsx)("h1",{className:"text-3xl font-extrabold text-gray-900 tracking-tight",children:"Deephy"}),Object(a.jsx)("p",{children:"Get a detailed balance of your DeFi tokens and an account overview. Click the button below to get started."}),this.isMetamaskInstalled()&&!this.state.web3&&Object(a.jsx)("button",{onClick:this.connectToMetaMask.bind(this),className:"text-white mt-auto bg-emerald-800 bg-opacity-50 hover:bg-opacity-75 transition-colors duration-200 rounded-xl font-semibold py-2 px-4 inline-flex",children:"Connect to MetaMask"}),s&&Object(a.jsxs)("p",{children:["Address:"," ",Object(a.jsx)("code",{children:Object(a.jsx)("small",{children:s})})]}),Object.values(r).length>0&&Object(a.jsx)("div",{children:Object(a.jsxs)("table",{className:"table-auto",children:[Object(a.jsx)("thead",{className:"bg-indigo-200",children:Object(a.jsxs)("tr",{children:[Object(a.jsx)("th",{className:"border border-light-blue-500 px-4 py-2 text-light-blue-600 font-medium",children:"Token"}),Object(a.jsx)("th",{className:"border border-light-blue-500 px-4 py-2 text-light-blue-600 font-medium",children:"Amount"}),Object(a.jsx)("th",{className:"border border-light-blue-500 px-4 py-2 text-light-blue-600 font-medium",children:"Current price"}),Object(a.jsx)("th",{className:"border border-light-blue-500 px-4 py-2 text-light-blue-600 font-medium",children:"Equity"})]})}),Object(a.jsxs)("tbody",{children:[n&&Object(a.jsxs)("tr",{children:[Object(a.jsx)("td",{className:"border border-light-blue-500 px-4 py-2 text-light-blue-600 font-medium",children:"ETH"}),Object(a.jsx)("td",{className:"border border-light-blue-500 px-4 py-2 text-light-blue-600 font-medium",children:i(+n)}),Object(a.jsx)("td",{className:"border border-light-blue-500 px-4 py-2 text-light-blue-600 font-medium",children:c(o)}),Object(a.jsx)("td",{className:"border border-light-blue-500 px-4 py-2 text-light-blue-600 font-medium",children:c(+n*o)})]}),Object.values(t).map(this.renderTokenBalance.bind(this))]})]})})]})})})})]})})}}]),n}(r.a.Component)),k=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,464)).then((function(t){var n=t.getCLS,a=t.getFID,s=t.getFCP,r=t.getLCP,i=t.getTTFB;n(e),a(e),s(e),r(e),i(e)}))};c.a.render(Object(a.jsx)(r.a.StrictMode,{children:Object(a.jsx)(v,{})}),document.getElementById("root")),k()}},[[458,1,2]]]);
//# sourceMappingURL=main.8b7d8f0a.chunk.js.map